<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Picos_randos (picos.Picos_randos)</title><meta charset="utf-8"/><link rel="stylesheet" href="../../odoc.support/odoc.css"/><meta name="generator" content="odoc 2.4.2"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../odoc.support/highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script><script>let base_url = '../../';
let search_urls = ['../db.js','../../sherlodoc.js'];
</script><script src="../../odoc.support/odoc_search.js" defer="defer"></script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> ‚Äì <a href="../index.html">picos</a> &#x00BB; Picos_randos</nav><div class="odoc-search"><div class="search-inner"><input class="search-bar" placeholder="üîé Search..."/><div class="search-snake"></div><div class="search-result"></div></div></div><header class="odoc-preamble"><h1>Module <code><span>Picos_randos</span></code></h1><p>Randomized multi-threaded effects based <a href="../Picos/index.html"><code>Picos</code></a> compatible scheduler for OCaml 5.</p><p>‚ÑπÔ∏è This scheduler implementation is specifically intended for testing libraries implemented in Picos.</p><p><a href="../Picos/index.html"><code>Picos</code></a> is an interface that allows schedulers to make scheduling decisions freely. After each effect this scheduler picks the next fiber to run randomly from the collection of ready fibers. This can help to discover bugs in programs implemented in Picos that make invalid scheduling assumptions.</p></header><div class="odoc-content"><div class="odoc-spec"><div class="spec type anchored" id="type-t"><a href="#type-t" class="anchor"></a><code><span><span class="keyword">type</span> t</span></code></div><div class="spec-doc"><p>Represents a shared context for randomized runners.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-context"><a href="#val-context" class="anchor"></a><code><span><span class="keyword">val</span> context : <span>unit <span class="arrow">&#45;&gt;</span></span> <a href="#type-t">t</a></span></code></div><div class="spec-doc"><p><code>context ()</code> creates a new context for randomized runners. The context should be consumed by a call of <a href="#val-run" title="run"><code>run ~context ...</code></a>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-runner_on_this_thread"><a href="#val-runner_on_this_thread" class="anchor"></a><code><span><span class="keyword">val</span> runner_on_this_thread : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p><code>runner_on_this_thread context</code> starts a runner on the current thread to run fibers on the context. The runner returns when <a href="#val-run" title="run"><code>run ~context ...</code></a> returns.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-run"><a href="#val-run" class="anchor"></a><code><span><span class="keyword">val</span> run : <span><span class="optlabel">?context</span>:<a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span><span class="optlabel">?forbid</span>:bool <span class="arrow">&#45;&gt;</span></span> <span><span>(<span>unit <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'a</span>)</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'a</span></span></code></div><div class="spec-doc"><p><code>run main</code> runs the <code>main</code> thunk with the scheduler. Returns after <code>main</code> and all of the fibers spawned by <code>main</code> have returned.</p><p>The optional <code>context</code> argument specifies a context in which to run the <code>main</code> thunk. If unspecified, a new context is automatically created and the scheduler will be single-threaded. By <a href="#val-context" title="context">creating a context</a>, spawning concurrent or parallel <a href="#val-runner_on_this_thread" title="runner_on_this_thread">runners</a> on to the context, and then explicitly passing the context to <code>run ~context ...</code> one can create a multi-threaded scheduler. Only a single call of <a href="#val-run"><code>run</code></a> per context is allowed.</p><p>The optional <code>forbid</code> argument defaults to <code>false</code> and determines whether propagation of cancelation is initially allowed.</p></div></div></div></body></html>
