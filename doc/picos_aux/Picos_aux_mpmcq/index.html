<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Picos_aux_mpmcq (picos_aux.Picos_aux_mpmcq)</title><meta charset="utf-8"/><link rel="stylesheet" href="../../odoc.support/odoc.css"/><meta name="generator" content="odoc 2.4.2"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../odoc.support/highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script><script>let base_url = '../../';
let search_urls = ['../db.js','../../sherlodoc.js'];
</script><script src="../../odoc.support/odoc_search.js" defer="defer"></script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> ‚Äì <a href="../index.html">picos_aux</a> &#x00BB; Picos_aux_mpmcq</nav><div class="odoc-search"><div class="search-inner"><input class="search-bar" placeholder="üîé Search..."/><div class="search-snake"></div><div class="search-result"></div></div></div><header class="odoc-preamble"><h1>Module <code><span>Picos_aux_mpmcq</span></code></h1><p>Lock-free multi-producer, multi-consumer queue.</p><p>üèéÔ∏è This data structure is optimized for use as a building block of the ready queue of a (mostly) fair (i.e. mostly FIFO) multi-threaded scheduler. For example, one could use a queue per thread, to reduce contention, and have threads attempt to pop fibers from the queues of other threads when their local queues are empty. It is also possible to use only a single shared queue, but that will result in very high contention as this queue is not relaxed.</p></header><nav class="odoc-toc"><ul><li><a href="#api">API</a></li><li><a href="#examples">Examples</a></li></ul></nav><div class="odoc-content"><h2 id="api"><a href="#api" class="anchor"></a>API</h2><div class="odoc-spec"><div class="spec type anchored" id="type-t"><a href="#type-t" class="anchor"></a><code><span><span class="keyword">type</span> <span>!'a t</span></span></code></div><div class="spec-doc"><p>A multi-producer, multi-consumer queue.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-create"><a href="#val-create" class="anchor"></a><code><span><span class="keyword">val</span> create : <span><span class="optlabel">?padded</span>:bool <span class="arrow">&#45;&gt;</span></span> <span>unit <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>create ()</code> returns a new empty multi-producer, multi-consumer queue.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-push"><a href="#val-push" class="anchor"></a><code><span><span class="keyword">val</span> push : <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p><code>push queue value</code> adds the <code>value</code> to the tail of the <code>queue</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-push_head"><a href="#val-push_head" class="anchor"></a><code><span><span class="keyword">val</span> push_head : <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p><code>push_head queue value</code> adds the <code>value</code> to the head of the <code>queue</code>.</p></div></div><div class="odoc-spec"><div class="spec exception anchored" id="exception-Empty"><a href="#exception-Empty" class="anchor"></a><code><span><span class="keyword">exception</span> </span><span><span class="exception">Empty</span></span></code></div><div class="spec-doc"><p>Raised by <a href="#val-pop_exn"><code>pop_exn</code></a> in case it finds the queue empty.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-pop_exn"><a href="#val-pop_exn" class="anchor"></a><code><span><span class="keyword">val</span> pop_exn : <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'a</span></span></code></div><div class="spec-doc"><p><code>pop_exn queue</code> tries to remove the value at the head of the <code>queue</code>. Returns the removed value or raises <a href="#exception-Empty"><code>Empty</code></a> in case the queue was empty.</p><ul class="at-tags"><li class="raises"><span class="at-tag">raises</span> <a href="#exception-Empty"><code>Empty</code></a> <p>in case the queue was empty.</p></li></ul></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-length"><a href="#val-length" class="anchor"></a><code><span><span class="keyword">val</span> length : <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> int</span></code></div><div class="spec-doc"><p><code>length queue</code> returns the length or the number of values in the <code>queue</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-is_empty"><a href="#val-is_empty" class="anchor"></a><code><span><span class="keyword">val</span> is_empty : <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> bool</span></code></div><div class="spec-doc"><p><code>is_empty queue</code> is equivalent to <a href="#val-length" title="length"><code>length queue = 0</code></a>.</p></div></div><h2 id="examples"><a href="#examples" class="anchor"></a>Examples</h2><p>An example top-level session:</p><pre class="language-ocaml"><code># let q : int Picos_aux_mpmcq.t =
    Picos_aux_mpmcq.create ()
val q : int Picos_aux_mpmcq.t = &lt;abstr&gt;

# Picos_aux_mpmcq.push q 42
- : unit = ()

# Picos_aux_mpmcq.push_head q 76
- : unit = ()

# Picos_aux_mpmcq.length q
- : int = 2

# Picos_aux_mpmcq.push q 101
- : unit = ()

# Picos_aux_mpmcq.pop_exn q
- : int = 76

# Picos_aux_mpmcq.pop_exn q
- : int = 42

# Picos_aux_mpmcq.pop_exn q
- : int = 101

# Picos_aux_mpmcq.pop_exn q
Exception: Picos_aux_mpmcq.Empty.</code></pre></div></body></html>
