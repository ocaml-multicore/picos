<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Lazy (picos.Picos_sync.Lazy)</title><meta charset="utf-8"/><link rel="stylesheet" href="../../../odoc.support/odoc.css"/><meta name="generator" content="odoc 2.4.1"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../odoc.support/highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script><script>let base_url = '../../../';
let search_urls = ['../../db.js','../../../sherlodoc.js'];
</script><script src="../../../odoc.support/odoc_search.js" defer="defer"></script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> ‚Äì <a href="../../index.html">picos</a> &#x00BB; <a href="../index.html">Picos_sync</a> &#x00BB; Lazy</nav><div class="odoc-search"><div class="search-inner"><input class="search-bar" placeholder="üîé Search..."/><div class="search-snake"></div><div class="search-result"></div></div></div><header class="odoc-preamble"><h1>Module <code><span>Picos_sync.Lazy</span></code></h1><p>A lazy implementation for <a href="../../Picos/index.html"><code>Picos</code></a>.</p><p>‚ÑπÔ∏è This intentionally mimics the interface of <code>Stdlib.Lazy</code>. Unlike with the stadard library suspensions an attempt to force a suspension from multiple fibers, possibly running on different domains, does not raise the <a href="#exception-Undefined"><code>Undefined</code></a> exception.</p></header><div class="odoc-content"><div class="odoc-spec"><div class="spec exception anchored" id="exception-Undefined"><a href="#exception-Undefined" class="anchor"></a><code><span><span class="keyword">exception</span> </span><span><span class="exception">Undefined</span></span></code></div><div class="spec-doc"><p>Synonym for <code>Stdlib.Lazy.Undefined</code>.</p></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-t"><a href="#type-t" class="anchor"></a><code><span><span class="keyword">type</span> <span>!'a t</span></span></code></div><div class="spec-doc"><p>Represents a deferred computation or suspension.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-from_fun"><a href="#val-from_fun" class="anchor"></a><code><span><span class="keyword">val</span> from_fun : <span><span>(<span>unit <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'a</span>)</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>from_fun thunk</code> returns a suspension.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-from_val"><a href="#val-from_val" class="anchor"></a><code><span><span class="keyword">val</span> from_val : <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>from_val value</code> returns an already forced suspension whose result is the given <code>value</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-is_val"><a href="#val-is_val" class="anchor"></a><code><span><span class="keyword">val</span> is_val : <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> bool</span></code></div><div class="spec-doc"><p><code>is_val susp</code> determines whether the suspension has already been forced and didn't raise an exception.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-force"><a href="#val-force" class="anchor"></a><code><span><span class="keyword">val</span> force : <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'a</span></span></code></div><div class="spec-doc"><p><code>force susp</code> forces the suspension, i.e. computes <code>thunk ()</code> using the <code>thunk</code> passed to <a href="#val-from_fun"><code>from_fun</code></a>, stores the result of the computation to the suspension and reproduces its result. In case the suspension has already been forced the computation is skipped and stored result is reproduced.</p><p>‚ÑπÔ∏è This will check whether the current fiber has been canceled before starting the computation of <code>thunk ()</code>. This allows the suspension to be forced by another fiber. However, if the fiber is canceled and the cancelation exception is raised after the computation has been started, the suspension will then store the cancelation exception.</p><ul class="at-tags"><li class="raises"><span class="at-tag">raises</span> <a href="#exception-Undefined"><code>Undefined</code></a> <p>in case the suspension is currently being forced by the <a href="../../Picos/Fiber/index.html#val-current" title="Picos.Fiber.current">current</a> fiber.</p></li></ul></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-force_val"><a href="#val-force_val" class="anchor"></a><code><span><span class="keyword">val</span> force_val : <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'a</span></span></code></div><div class="spec-doc"><p><code>force_val</code> is a synonym for <a href="#val-force"><code>force</code></a>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-map"><a href="#val-map" class="anchor"></a><code><span><span class="keyword">val</span> map : <span><span>(<span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'b</span>)</span> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'b</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>map fn susp</code> is equivalent to:</p><pre class="language-ocaml"><code>from_fun (fun () -&gt; fn (force susp))</code></pre></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-map_val"><a href="#val-map_val" class="anchor"></a><code><span><span class="keyword">val</span> map_val : <span><span>(<span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'b</span>)</span> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'b</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>map_val fn susp</code> is equivalent to:</p><pre class="language-ocaml"><code>if is_val susp then
  from_val (fn (force susp))
else
  map fn susp</code></pre></div></div></div></body></html>
